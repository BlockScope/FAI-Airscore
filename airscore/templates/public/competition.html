
{% extends "base.html"%}
{% block content %}
{% if error %}
<p><strong> Error: </strong></p> {{error}}
{% endif %}
<form method="post" action="{{url_for('public.comp_settings_admin', compid=compid)}}">
    {{compform.hidden_tag()}}

    <div class="container"><br>
      <center>
        <h2 class="font-weight-bold">{{compform.comp_name.data}}</h2>
      </center>
    </div>

    <p>
  <button class="btn btn-primary ml-4" type="button" data-toggle="collapse" data-target="#collapse1" aria-expanded="false" aria-controls="collapseExample">
    Competition Details
  </button>
</p>
<div class="collapse show" id="collapse1">
  <div class="card card-body">
      <div class="container">
          <h3 class="font-weight-bold">Competition Details</h3>
  <div class="form-row">
    <div class="form-group col-md-6">
      {{compform.comp_name.label}} {{compform.comp_name()}}
    </div>
    <div  class="form-group col-md-6">
      {{compform.comp_code.label}} {{compform.comp_code(**{'data-toggle': 'tooltip', 'title': compform.comp_code.description})}}
    </div>
    </div>

    <div  class="form-row">
       <div class="form-group col-md-6">
       {{compform.comp_site.label}} {{compform.comp_site(**{'data-toggle': 'tooltip', 'title': compform.comp_site.description})}}
    </div>
    <div  class="form-group col-md-6">
      {{compform.date_from.label}} {{compform.date_from()}}
         {{compform.date_to.label}} {{compform.date_to()}}
    </div>
    </div>
    <div class="form-row">
    <div class="form-group" col-md-3">
      {{compform.comp_type.label}} {{compform.comp_type()}}
      {{compform.comp_class.label}} {{compform.comp_class()}}
    {{compform.time_offset.label}} {{compform.time_offset(size=3,**{'data-toggle': 'tooltip', 'title': compform.time_offset.description})}}
    {{compform.pilot_registration.label}} {{compform.pilot_registration(**{'data-toggle': 'tooltip', 'title': compform.pilot_registration.description})}}
    </div>
  </div>
  <div class="form-row">
      <div class="form-group" col-md-3">
    {{compform.MD_name.label}} {{compform.MD_name()}}
  </div>

    </div>

    </div>

</div>
</div>



        <p>
  <button class="btn btn-primary ml-4" type="button" data-toggle="collapse" data-target="#collapse2" aria-expanded="false" aria-controls="collapseExample">
    Scoring Parameters
  </button>
</p>
<div class="collapse" id="collapse2">
  <div class="card card-body">
      <div class="container">
          <h3 class="font-weight-bold">Scoring Parameters</h3>
  <div class="form-row">
    <div class="form-group col-md-6">
        {{compform.formula.label}} {{compform.formula(**{'data-toggle': 'tooltip', 'title': compform.formula.description})}}
        {{compform.overall_validity.label}} {{compform.overall_validity(**{'data-toggle': 'tooltip', 'title': compform.overall_validity.description})}}
        {{compform.validity_param.label}} {{compform.validity_param(size=3,**{'data-toggle': 'tooltip', 'title': compform.validity_param.description})}}
    </div>
    </div>

    <div  class="form-row">
       <div class="form-group col-md-2">
       {{compform.nom_dist.label}} {{compform.nom_dist(size=3, **{'data-toggle': 'tooltip', 'title': compform.nom_dist.description})}}
    </div>
        <div class="form-group col-md-2">
       {{compform.min_dist.label}} {{compform.min_dist(size=3,**{'data-toggle': 'tooltip', 'title': compform.min_dist.description})}}
    </div>

    <div  class="form-group col-md-2">
      {{compform.nom_goal.label}} {{compform.nom_goal(size=3,**{'data-toggle': 'tooltip', 'title': compform.nom_goal.description})}}
           </div>
         <div  class="form-group col-md-2">
         {{compform.nom_launch.label}} {{compform.nom_launch(size=3,**{'data-toggle': 'tooltip', 'title': compform.nom_launch.description})}}
    </div>
                 <div  class="form-group col-md-2">
         {{compform.nom_time.label}} {{compform.nom_time(size=3,**{'data-toggle': 'tooltip', 'title': compform.nom_time.description})}}
    </div>


    </div>


    </div>

    </div>

</div>

    <p>
  <button class="btn btn-primary ml-4" type="button" data-toggle="collapse" data-target="#collapse3" aria-expanded="false" aria-controls="collapseExample">
    Management
  </button>
</p>
<div class="collapse" id="collapse3">
  <div class="card card-body">
      <div class="container">
          <h3 class="font-weight-bold">Management</h3>
  <div class="form-row">
    <div class="form-group col-md-6">
        <h6 font-weight-bold>Admins:</h6>
        <table>
        {% for admin in admins %}
            <TR>
            <TD class="c3">{{admin}}</TD>
            </TR>
        {% endfor %}
            </table>
        <button id="add_admin" class="btn btn-secondary" type="button">Add admin</button>

    </div>
    </div>
            <div class="form-row">
    <div class="form-group col-md-6">
             {{compform.locked.label}} {{compform.locked(**{'data-toggle': 'tooltip', 'title': compform.locked.description})}}
                </div>
    </div>
        </div>
    </div>
    </div>



      <p>
  <button class="btn btn-primary ml-4" type="button" data-toggle="collapse" data-target="#collapse4" aria-expanded="false" aria-controls="collapseExample">
    Tasks
  </button>
</p>
<div class="collapse" id="collapse4">
  <div class="card card-body">
      <div class="container">
          <h3 class="font-weight-bold">Tasks</h3>
  <div class="form-row">
    <div class="form-group col-md-6">
                <table>
        {% for task in tasks %}
            <TR>
            <TD class="c3">{{task['link']|safe}}</TD>
                <td>{{task['date']}}</td>
                <td>{{task['opt_dist']}}</td>
                <td>{{task['comment']}}</td>
            </TR>
        {% endfor %}
            </table>
        <p>
            <button id="add_task" class="btn btn-secondary" type="button" data-toggle="collapse" data-target="#collapse5" aria-expanded="false" aria-controls="collapseExample">
                Add task
            </button>
        </p>
<div class="collapse" id="collapse5">
  <div class="card card-body">
      <div class="container">

  <div class="form-row">
    <div class="form-group width4">
        {{taskform.task_number.label}}{{taskform.task_number(size=2, **{'data-toggle': 'tooltip', 'title': taskform.task_number.description})}}
        {{taskform.task_date.label}} {{taskform.task_date()}}
    </div>

    </div>
          <div class="form-row">
                 <div class="form-group col-md-6">
              {{taskform.task_name.label}} {{taskform.task_name(**{'data-toggle': 'tooltip', 'title': taskform.task_name.description})}}
                 </div>
              <div class="form-group col-md-6">
        {{taskform.task_comment.label}} {{taskform.task_comment(**{'data-toggle': 'tooltip', 'title': taskform.task_comment.description})}}

                 </div>


          </div>

                    <div class="form-row">

            <button id="save_task" class="btn btn-success" type="button" >
                Add
            </button>


          </div>
    </div>
    </div>

        </div>



    </div>
    </div>
        </div>
    </div>
    </div>



    <div class="container"><br>
      <center>
            {{compform.submit(class="btn-success")}}
      </center>
    </div>


</form>
    <!-- Bootstrap core JavaScript -->
<!--    <script type="text/javascript" src="js/enums.js"></script>-->
<!--    <script src="{{ static_url_for('static', filename='js/pop_comp_details.js') }}"></script>-->


<script charset="utf-8" type="text/javascript">

$(function() {

    // jQuery selection for the 2 select boxes
    var dropdown = {
        category: $('#select_category'),
        formula: $('#select_formula')
    };

    // call to update on load
    updateFormulas();

    // function to call XHR and update formula dropdown
    function updateFormulas() {
        var send = {
            category: dropdown.category.val()
        };
        dropdown.formula.attr('disabled', 'disabled');
        dropdown.formula.empty();
        $.getJSON("{{ url_for('public._get_formulas') }}", send, function(data) {
            data.forEach(function(item) {
                dropdown.formula.append(
                    $('<option>', {
                        value: item[0],
                        text: item[1]
                    })
                );
            });
            dropdown.formula.removeAttr('disabled');
        });
    }

    // event listener to state dropdown change
    dropdown.category.on('change', function() {
        updateFormulas();
    });

});

</script>

{% endblock %}




