{% extends "layout.html"%}

{% block content %}
<!-- <script src="https://rawgit.com/DashboardCode/BsMultiSelect/master/dist/js/BsMultiSelect.min.js"></script> -->

<link rel="stylesheet" href="https://unpkg.com/leaflet@1.1.0/dist/leaflet.css"
   integrity="sha512-wcw6ts8Anuw10Mzh9Ytw4pylW8+NAD4ch3lqm9lzAsTxg0GFeJgoAtxuCLREZSC5lUXdVyo/7yfsqFjQ4S+aKw=="
   crossorigin=""/>
   <!-- Make sure you put this AFTER Leaflet's CSS -->

<!--<script src="/static/leaflet.elevation-0.0.4.js" crossorigin="anonymous"></script>-->
<link rel="stylesheet" href="/static/css/BsMultiSelect.css" crossorigin="anonymous">

<h1>Track Map: {{task}} {{pilot}}</h1>
<div id="map">
{{map|safe}}
</div>

<form action="/" method="post">
<div class="container">
   <div class="form-group row">
                        <label class="col-form-label col-sm-2" for="edit-states1-id">Add Tracks</label>
                        <div class="col-sm-10">
                            <select name="tracks" id="select-tracks-id" class="form-control test"  multiple="multiple" style="display: none;">
                            {%for t in other_tracks%}
                            <option value="{{t[0]}}">{{t[1]}}</option>
                            {% endfor %}
                            </select>
                        </div>
                    </div>
<button type="button" class="btn btn-primary" id="submit-tracks">Get Tracks</button>
</div>

</form>

<div class="container">
  <table class="table table-striped " id="wpt_achieved_table">
    <thead>
      <tr>
        <th scope="col">Waypoint</th>
        <th scope="col">GPS Alt</th>
        <th scope="col">Baro Alt</th>
        <th scope="col">Time of day</th>
        <th scope="col">Straight line dist<br> from previous (km)</th>
        <th scope="col">Time from previous</th>
        <th scope="col">Speed from previous (kph)</th>
      </tr>
    </thead>
    <tbody id=wpt_achieved_table_body>

      {%for w in wpt_achieved %}
        <tr>
          <td>{{w[4]}}</td>
          <td>{{w[2]}}</td>
          <td>{{w[3]}}</td>
          <td>{{w[5]}}</td>
          <td>{{w[8]}}</td>
          <td>{{w[9]}}</td>
          <td>{{w[10]}}</td>
        </tr>
      {% endfor %}

    </tbody>
  </table>
</div>


<script>var $multiSelects = $("select[multiple='multiple']");
function install(){
                $multiSelects.bsMultiSelect();
}
install();</script>

<script>
  tracks=[]
  $(document).ready(function() {
    $("#submit-tracks").click(function(){
        tracks = $('#select-tracks-id').val();
        if(tracks.length > 0){
          fetch('/_map/9999/' + tracks).then(function(response) {
                          response.text().then(function(data) {

                         map.innerHTML = data;
                       })

                   });
        }
        else {
    $(location).attr('href','/map/9999');

        }
    });
});
</script>


{% endblock %}

{% block js %}
{% include "js.html" %}
    <script type="text/javascript" src="https://cdn.datatables.net/1.10.21/js/jquery.dataTables.min.js"></script>
    <script type="text/javascript" src="/static/js/BsMultiSelect.js"></script>
    <script src="https://unpkg.com/leaflet@1.1.0/dist/leaflet.js"
      integrity="sha512-mNqn2Wg7tSToJhvHcqfzLMU6J4mkOImSPTxVZAdo+lcPlk+GhZmYgACEe0x35K7YzW1zJ7XyJV/TT1MrdXvMcA=="
      crossorigin=""></script>


     <script src="https://d3js.org/d3.v3.min.js" charset="utf-8"></script>
{% endblock %}
